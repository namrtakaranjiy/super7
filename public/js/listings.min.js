"use strict";function updateControls(e){$("#street_number").val(e.streetNumber),$("#route").val(e.streetName),e.city&&$("#city").val(e.city),$("#state").val(e.stateOrProvince),$("#postal_code").val(e.postalCode),$("#country").val(e.country)}function show_error_message(e){$("#notice").show(),$("#notice span").html(e)}"basics"==page?$("#listing_bes").validate({submitHandler:function(e){return $("#btn_next").on("click",function(e){$("#btn_next").attr("disabled",!0),e.preventDefault()}),$(".spinner").removeClass("d-none"),$("#btn_next-text").text(nextText),!0}}):"description"==page?$("#list_des").validate({rules:{name:{required:!0},summary:{required:!0}},submitHandler:function(e){return $("#btn_next").on("click",function(e){$("#btn_next").attr("disabled",!0),e.preventDefault()}),$(".spinner").removeClass("d-none"),$("#btn_next-text").text(nextText),!0},messages:{name:{required:fieldRequiredText},summary:{required:fieldRequiredText,maxlength:maxlengthText}}}):"details"==page?$("#listing_det").validate({submitHandler:function(e){return $("#btn_next").on("click",function(e){$("#btn_next").attr("disabled",!0),e.preventDefault()}),$(".spinner").removeClass("d-none"),$("#btn_next-text").text(nextText),!0}}):"location"==page?($("#map_view").locationpicker({location:{latitude:latitude,longitude:longitude},radius:0,addressFormat:"",inputBinding:{latitudeInput:$("#latitude"),longitudeInput:$("#longitude"),locationNameInput:$("#address_line_1")},enableAutocomplete:!0,onchanged:function(e,t,n){updateControls($(this).locationpicker("map").location.addressComponents)},oninitialized:function(e){updateControls($(e).locationpicker("map").location.addressComponents)}}),$("#lis_location").validate({rules:{address_line_1:{required:!0,maxlength:255},address_line_2:{maxlength:255},city:{required:!0},state:{required:!0}},submitHandler:function(e){return $("#btn_next").on("click",function(e){$("#btn_next").attr("disabled",!0),e.preventDefault()}),$(".spinner").removeClass("d-none"),$("#btn_next-text").text(nextText),!0},messages:{"amenities[]":{required:fieldRequiredText}},messages:{address_line_1:{required:fieldRequiredText,maxlength:maxlengthText},address_line_2:{required:fieldRequiredText,maxlength:maxlengthText},city:{required:fieldRequiredText},state:{required:fieldRequiredText}}})):"amenities"==page?$(document).on("click","#btn_next",function(e){$(".spinner").removeClass("d-none"),$("#btn_next-text").text(nextText),$("#btn_next").attr("disabled",!0),e.preventDefault();var t=$("[name='amenities[]']");let n=[],o=0,a=0;var i=$("#amenity_type_id").val();jQuery.each(t,function(e){$(this).is(":checked")&&n.push($(this).attr("data-saving"))}),$.each(n,function(e,t){t==i?o++:a++}),1<=o?$("#amenities_id").submit():($("#at_least_one").css("color","red"),$("#at_least_one").css("padding-top","0.625rem"),$("#at_least_one").html(mendatoryAmenitiesText),$("#at_least_one").css("fontSize","14px"),$(".spinner").addClass("d-none"),$("#btn_next-text").text(next),$("#btn_next").attr("disabled",!1),e.preventDefault(),$("html,body").animate({scrollTop:$("#at_least_one").offset().top-700},1e3))}):"photos"==page?($(document).on("submit","#photo-form",function(e){e.preventDefault(),$("#photo").hide();e=new FormData(this);""!=$("#photo_file").val()&&($.ajax({url:photoUploadURL,data:{form_data:e,_token:token},type:"post",dataType:"json",processData:!1,contentType:!1,success:function(e){e.status?(e='<div class="col-md-4 margin-top10" id="photo-div-'+e.photo_id+'"><div class="room-image-container200" style="background-image:url('+photoRoomURl+"/"+e.photo_name+');"><a class="photo-delete" href="#" data-rel="'+e.photo_id+'"><p class="photo-delete-icon"><i class="fa fa-trash-o"></i></p></a></div><div class="margin-top5"><textarea data-rel="'+e.photo_id+'" class="form-control photo-highlights" placeholder="'+highlightsPhotoText+'"></textarea></div></div>',$("#photo-list-div").append(e)):$("#photo").show()},error:function(e,t){show_error_message(networkErrorText)}}),$("#photo_file").val(""))}),$(document).on("focusout",".photo-highlights",function(e){var t=$(this).attr("data-rel"),n=$(this).val();$.ajax({url:photoMessageURL,data:{photo_id:t,messages:n,_token:token},type:"post",dataType:"json",success:function(e){},error:function(e,t){show_error_message(networkErrorText)}})}),$(document).on("click",".photo-delete",function(e){gl_photo_id=$(this).attr("data-rel"),event.preventDefault(),swal({title:areYouSureText,text:deleteForeverText,icon:"warning",buttons:{cancel:{text:cancelText,value:null,visible:!0,className:"btn btn-outline-danger text-16 font-weight-700  pt-3 pb-3 pl-5 pr-5",closeModal:!0},confirm:{text:okText,value:!0,visible:!0,className:"btn vbtn-outline-success text-16 font-weight-700 pl-5 pr-5 pt-3 pb-3 pl-5 pr-5",closeModal:!0}},dangerMode:!0}).then(e=>{var t;e&&(e=photoDeleteURL,t=gl_photo_id,$.ajax({url:e,data:{photo_id:t,_token:token},type:"post",dataType:"json",success:function(e){e.success&&($("#photo-div-"+t).remove(),swal({icon:"success",buttons:{confirm:{text:deletedText,value:!0,visible:!0,className:"btn vbtn-outline-success text-16 font-weight-700 pl-5 pr-5 pt-3 pb-3 pl-5 pr-5",closeModal:!0}}}))},error:function(e,t){show_error_message(e.statusText)}}))})}),$(document).on("change","#photoId",function(e){var t=$(this).val(),n=$("option:selected",this).attr("image_id"),o=$("option:selected",this).attr("property_id");$.ajax({url:makeDefaultPhotoURL,data:{photo_id:n,property_id:o,option_value:t,_token:token},type:"post",dataType:"json",success:function(e){location.reload()}})}),$(document).on("change",".serial",function(e){var t=$(this).val(),n=$(this).attr("image_id");$.ajax({url:makePhotoSerialURL,data:{id:n,serial:t,_token:token},type:"post",dataType:"json",success:function(e){location.reload()}})}),$("#img_form").validate({rules:{"photos[]":{required:!0,accept:"image/jpg,image/jpeg,image/png,image/gif,image/JPG"}},submitHandler:function(e){return $("#up_button").on("click",function(e){$("#up_button").attr("disabled",!0),e.preventDefault()}),$("#up_spin").removeClass("d-none"),$("#up_button_txt").text(uploadText),!0},messages:{"photos[]":{accept:imageMendatoryTypeText}}}),$(document).on("click","#btnnext",function(){$(this).addClass("disabled"),$("#btn_spin").removeClass("d-none"),$("#btnnext-text").text(nextText)}),$("#photo_file").on("change",function(){var e,n=$("#canvas"),o=n.get(0).getContext("2d"),a=$("#result img"),i=this.files[0].name;this.files&&this.files[0]?this.files[0].type.match(/^image\//)?($(".crop-modal").modal("toggle"),(e=new FileReader).onload=function(e){var t=new Image;t.onload=function(){o.canvas.height=t.height,o.canvas.width=t.width,o.drawImage(t,0,0),$("#img_name").val(i);n.cropper({});$(document).on("click","#crop",function(){var e=n.cropper("getCroppedCanvas").toDataURL("image/png");a.attr("src",e),$("#result").show(),$("#photo").val(e),$("#type").val("crop"),n.cropper("destroy"),$(".crop-modal").modal("toggle"),$("#up_button").click()}),$(document).on("click","#restore",function(){n.cropper("destroy"),a.empty(),$("#type").val("original"),$("#up_button").click()})},t.src=e.target.result},e.readAsDataURL(this.files[0])):show_error_message(invalidImagetypeText):show_error_message(noFileSelectedText)})):"pricing"==page?($(document).on("change",".pricing_checkbox",function(){var e;this.checked?(e=$(this).attr("data-rel"),$("#"+e).show()):(e=$(this).attr("data-rel"),$("#"+e).hide(),$("#price-"+e).val(0))}),$(document).on("click","#show_long_term",function(){$("#js-set-long-term-prices").hide(),$("#long-term-div").show()}),$(document).on("change","#price-select-currency_code",function(){var e=$(this).val();$.ajax({url:currencySymbolURL,data:{_token:token,currency:e},type:"post",dataType:"json",success:function(e){1==e.success&&$(".pay-currency").html(e.symbol)},error:function(e,t){}})}),$("#lis_pricing").validate({rules:{price:{required:!0,number:!0,min:5},weekly_discount:{number:!0,max:99,min:0},monthly_discount:{number:!0,max:99,min:0}},errorPlacement:function(e,t){"price"==t.attr("name")?e.appendTo("#price-error"):e.insertAfter(t)},submitHandler:function(e){return $("#btn_next").on("click",function(e){$("#btn_next").attr("disabled",!0),e.preventDefault()}),$(".spinner").removeClass("d-none"),$("#btn_next-text").text(nextText),!0},messages:{price:{required:fieldRequiredText,number:validNumberText,min:priceMinValue},weekly_discount:{number:validNumberText,max:discountsMaxValue,min:discountsMinValue},monthly_discount:{number:validNumberText,max:discountsMaxValue,min:discountsMinValue}}})):"booking"==page?$("#booking_id").validate({rules:{booking_type:{required:!0}},submitHandler:function(e){return $("#btn_next").on("click",function(e){$("#btn_next").attr("disabled",!0),e.preventDefault()}),$(".spinner").removeClass("d-none"),$("#btn_next-text").text(nextText),!0},messages:{booking_type:{required:fieldRequiredText}}}):"calendar"==page&&($(document).on("click","#cal_sync",function(){$(this).addClass("disabled"),$("#cal_sync_spinner").removeClass("d-none")}),$(document).on("click","#btn_next",function(){$(this).addClass("disabled"),$("#btn_next_spinner").removeClass("d-none"),$("#btn_next-text").text(nextText)}),$("#icalendar_form").validate({rules:{url:{required:!0,maxlength:255},name:{required:!0,maxlength:255}},submitHandler:function(e){return $("#import_btn").on("click",function(e){$("#import_btn").attr("disabled",!0),e.preventDefault()}),$("#import_spinner").removeClass("d-none"),$("#import_btn-text").text(importCalendarText),!0},messages:{url:{required:fieldRequiredText,minlength:minLengthText},name:{required:fieldRequiredText,minlength:minLengthText}}}));